define([],function(){function getLegalPercentValue(newPercent){return newPercent<0&&(newPercent=0),newPercent>100&&(newPercent=100),newPercent}function TradeSliderBar(config){function chooseAnyPercent(event){if(!dragStopping){var percent=1*(event.offsetX/totalWidth*100).toFixed(2);percent=getLegalPercentValue(percent),self.changePercent(percent),config.roundNumber&&(percent=Math.round(percent)),self.onPercentChangeFn(percent),self.onPercentChangeEndFn(percent)}}function changePercent(percent,event){self.currPercent=percent,renderView(percent),event&&(self.onPercentChangeFn(percent),self.onPercentChangeEndFn(percent),event.stopPropagation())}function calculateNewPercent(startX,endX){var movePercent=(endX-startX)/totalWidth*100,newPercent=1*(self.currPercent+movePercent).toFixed(2);return getLegalPercentValue(newPercent)}function renderView(percent){var width=percent+"%",left=-4,sliderLine=self.$container.find(".sliderLine"),dragBar=self.$container.find(".dragBar"),percentNum=self.$container.find(".percentNum");sliderLine.css("width",width),0!=percent&&(left=Math.max(left,totalWidth*percent*.01-8)),dragBar.css("margin-left",left+"px");var type=config.type,bgClass="quarterBlue";type&&(bgClass="buy"==type?"quarterGreen":"quarterRed"),self.$container.find("a").each(function(){var $this=jQuery(this),percent=Number($this.attr("percent"));self.currPercent>percent?$this.addClass(bgClass):$this.removeClass(bgClass)}),config.roundNumber&&(percent=Math.round(percent)),percentNum.html(percent+"%")}var totalWidth=config.width||212,startX=-1,endX=-1,dragging=!1,dragStopping=!1,$container=jQuery("#"+config.containerId);if(!($container.length<1)){$container.html(content),$container.children().addClass("width"+totalWidth);var lineClass="lineBlue";config.type&&(lineClass="buy"==config.type?"lineGreen":"lineRed"),$container.find(".sliderLine").addClass(lineClass);var sliderBody=$container.find(".sliderBody"),$sliderQuarter=$container.find("a");sliderBody.css("width",totalWidth+"px");var dragBar=$container.find(".dragBar").get(0);this.$container=$container,this.currPercent=0,this.onPercentChangeFn=function(percent){},this.onPercentChangeEndFn=function(percent){};var self=this;sliderBody.click(function(e){chooseAnyPercent(e)}),$sliderQuarter.click(function(e){var percent=jQuery(this).attr("percent");changePercent(parseInt(percent),e)}),dragBar.addEventListener("mousedown",function(e){dragging=!0,startX=endX=e.pageX}),document.addEventListener("mouseup",function(e){dragging&&(dragging=!1,dragStopping=!0,setTimeout(function(){dragStopping=!1},100),self.onPercentChangeEndFn(self.currPercent))}),document.addEventListener("mousemove",function(e){if(dragging){window.getSelection?window.getSelection().removeAllRanges():document.selection.empty(),endX=e.pageX;var percent=calculateNewPercent(startX,endX);changePercent(percent),config.roundNumber&&(percent=Math.round(percent)),self.onPercentChangeFn(percent),startX=endX}}),this.changePercent=changePercent}}var content=(window,'<div class="tradeSliderBar">  <div class="sliderBody" tabindex="-1">     <a class="quarter quarterOne" percent="0"></a>     <a class="quarter quarterTwo" percent="25"></a>     <a class="quarter quarterThree" percent="50"></a>     <a class="quarter quarterFour" percent="75"></a>     <a class="quarter quarterFive" percent="100"></a>     <div class="sliderLine">         <div class="dragBar"></div>     </div>  </div>  <span class="percentNum">0%</span></div>');return TradeSliderBar.prototype.onPercentChange=function(fn){"function"==typeof fn&&(this.onPercentChangeFn=fn)},TradeSliderBar.prototype.onPercentChangeEnd=function(fn){"function"==typeof fn&&(this.onPercentChangeEndFn=fn)},TradeSliderBar.prototype.setPercent=function(percent){percent=Number(percent),percent>100&&(percent=100),this.changePercent&&this.changePercent(percent)},TradeSliderBar.prototype.getCurrPercent=function(){return this.currPercent},TradeSliderBar});